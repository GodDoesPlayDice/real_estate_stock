<script type="text/babel">
class Header extends React.Component {
    constructor (props) {
        super(props);
        this.handleChange = this.handleChange.bind(this);
        this.state = {
            current_view: this.props.current_view
        }
    };
    handleChange(pressed) {
        this.props.onChange("current_view", pressed);
        this.setState({
            current_view: pressed
        });
    };
    componentDidMount () {
        // инициализация автокомплита
        let elems = document.querySelectorAll('.autocomplete');
        let instances = M.Autocomplete.init(elems, {
                data: this.props.docsList
        });
    }
    render () {
        return (
            <div class="navbar-fixed">
                <nav class="indigo" >
                    <div class="nav-wrapper container row">
                        <div class="col s3">
                            <a href="#" class="brand-logo">{this.props.logo}</a>
                        </div>
                        <form class="col s5">
                            <div class="input-field">
                                <input id="search" type="search" class="autocomplete" placeholder="Поиск сделки" required />
                                <i class="material-icons">close</i>
                            </div>
                        </form>
                        <div class="col s4">
                            <ul id="nav-mobile" class="right hide-on-med-and-down">
                                {this.state.current_view === 'view_main' &&
                                    <TopMenuButton 
                                    action="create_new_doc" 
                                    label="Новый документ"
                                    onChange={this.handleChange}
                                    />
                                }
                                {this.state.current_view === 'create_new_doc' &&
                                    <TopMenuButton 
                                    action="view_main"
                                    label="Назад"
                                    onChange={this.handleChange}
                                    />
                                }
                            </ul>
                        </div>
                    </div>
                </nav>
            </div>    
        );
    }
}

class TopMenuButton extends React.Component {
    constructor (props) {
        super(props);
        this.handleClick = this.handleClick.bind(this);
    };
    handleClick() {
        this.props.onChange(this.props.action)
    }
    render () {
        return (
            <li><a href="#" onClick={this.handleClick}>{this.props.label}</a></li>
        )
    }
}


class Modal extends React.Component {
    constructor(props) {
        super(props);
        this.handleClick = this.handleClick.bind(this);
    }
    handleClick(e) {
        this.props.onDecision(e.target.id);

        let elem = document.getElementById(this.props.id);
        var instance = M.Modal.getInstance(elem);
        instance.close();
    }
    componentDidMount () {
        let elem = document.getElementById(this.props.id);
        let instance = M.Modal.init(elem, {});
        instance.open();
    };
    componentWillUnmount(){
    }
    render(){
        return (
            <div>
                <div id={this.props.id} class="modal">
                    <div class="modal-content">
                        <h4>Подтверждени сохранения данных</h4>
                        <p>Вы хотите сохранить:</p>
                    </div>
                    <div class="modal-footer">
                        <a href="#"  onClick={this.handleClick} id="cancel"class="modal-close waves-effect waves-green btn-flat">Отмена</a>
                        <a href="#"  onClick={this.handleClick} id="confirmed" class="modal-close waves-effect waves-green btn-flat">Сохранить</a>
                    </div>
                </div>
            </div>
        );
    }
}
</script>